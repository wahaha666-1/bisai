<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSeek ç½‘ç»œè¯Šæ–­å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }
        
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
        }
        
        .test-title {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .test-result {
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.2s;
            display: block;
            margin: 20px auto;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .loading {
            text-align: center;
            padding: 20px;
            color: #667eea;
            font-size: 16px;
        }
        
        .back-link {
            text-align: center;
            margin-top: 20px;
        }
        
        .back-link a {
            color: #667eea;
            text-decoration: none;
            font-size: 14px;
        }
        
        .back-link a:hover {
            text-decoration: underline;
        }
        
        ul {
            margin: 10px 0;
            padding-left: 25px;
        }
        
        li {
            margin: 5px 0;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” DeepSeek ç½‘ç»œè¯Šæ–­å·¥å…·</h1>
        
        <div id="results"></div>
        
        <button class="btn" onclick="runTests()">ğŸš€ å¼€å§‹è¯Šæ–­</button>
        
        <div class="back-link">
            <a href="/workspace">â† è¿”å›å·¥ä½œå°</a>
        </div>
    </div>
    
    <script>
        async function runTests() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="loading">ğŸ”„ æ­£åœ¨è¯Šæ–­ï¼Œè¯·ç¨å€™...</div>';
            
            let html = '';
            
            // æµ‹è¯•1ï¼šæµè§ˆå™¨ç½‘ç»œè¿æ¥
            html += '<div class="test-section">';
            html += '<div class="test-title">1ï¸âƒ£ æµ‹è¯•ï¼šæµè§ˆå™¨ç½‘ç»œè¿æ¥</div>';
            
            if (navigator.onLine) {
                html += '<div class="test-result success">âœ… æµè§ˆå™¨æ˜¾ç¤ºå·²è¿æ¥åˆ°ç½‘ç»œ</div>';
            } else {
                html += '<div class="test-result error">âŒ æµè§ˆå™¨æ˜¾ç¤ºæœªè¿æ¥åˆ°ç½‘ç»œ<br>è¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥</div>';
            }
            html += '</div>';
            
            // æµ‹è¯•2ï¼šDeepSeek API è¿é€šæ€§
            html += '<div class="test-section">';
            html += '<div class="test-title">2ï¸âƒ£ æµ‹è¯•ï¼šDeepSeek API è¿é€šæ€§</div>';
            
            try {
                const startTime = Date.now();
                const response = await fetch('https://api.deepseek.com', {
                    method: 'GET',
                    mode: 'no-cors',  // é¿å…CORSé—®é¢˜
                    cache: 'no-cache'
                });
                const endTime = Date.now();
                const duration = endTime - startTime;
                
                html += `<div class="test-result success">âœ… æˆåŠŸè¿æ¥åˆ° DeepSeek API<br>å“åº”æ—¶é—´: ${duration}ms</div>`;
            } catch (error) {
                html += '<div class="test-result error">âŒ æ— æ³•è¿æ¥åˆ° DeepSeek API<br><br>';
                html += '<strong>å¯èƒ½çš„åŸå› ï¼š</strong><ul>';
                html += '<li>ç½‘ç»œé˜²ç«å¢™é˜»æ­¢äº†è¿æ¥</li>';
                html += '<li>DNS è§£æå¤±è´¥</li>';
                html += '<li>éœ€è¦é…ç½®ä»£ç†</li>';
                html += '<li>åœ°åŒºç½‘ç»œé™åˆ¶</li>';
                html += '</ul>';
                html += '<strong>å»ºè®®ï¼š</strong><ul>';
                html += '<li>æ£€æŸ¥é˜²ç«å¢™è®¾ç½®</li>';
                html += '<li>å°è¯•æ›´æ¢ç½‘ç»œï¼ˆå¦‚æ‰‹æœºçƒ­ç‚¹ï¼‰</li>';
                html += '<li>è”ç³»ç½‘ç»œç®¡ç†å‘˜</li>';
                html += '</ul></div>';
            }
            html += '</div>';
            
            // æµ‹è¯•3ï¼šé…ç½®çŠ¶æ€
            html += '<div class="test-section">';
            html += '<div class="test-title">3ï¸âƒ£ æ£€æŸ¥ï¼šAPI Key é…ç½®çŠ¶æ€</div>';
            
            try {
                const configResponse = await fetch('/api/chat/config');
                const configData = await configResponse.json();
                
                if (configData.configured) {
                    html += '<div class="test-result success">âœ… API Key å·²é…ç½®<br>';
                    if (configData.key_prefix) {
                        html += `å½“å‰é…ç½®: <code>${configData.key_prefix}</code>`;
                    }
                    html += '</div>';
                } else {
                    html += '<div class="test-result warning">âš ï¸ API Key æœªé…ç½®<br><br>';
                    html += '<strong>æ“ä½œæ­¥éª¤ï¼š</strong><ol>';
                    html += '<li>è®¿é—® <a href="https://platform.deepseek.com" target="_blank">DeepSeek å®˜ç½‘</a></li>';
                    html += '<li>æ³¨å†Œ/ç™»å½•è´¦å·</li>';
                    html += '<li>åˆ›å»º API Key</li>';
                    html += '<li>è¿”å›å¯¹è¯é¡µé¢ï¼Œç‚¹å‡»ã€Œé…ç½®ã€æŒ‰é’®</li>';
                    html += '<li>ç²˜è´´ API Key å¹¶ä¿å­˜</li>';
                    html += '</ol></div>';
                }
            } catch (error) {
                html += '<div class="test-result error">âŒ æ— æ³•è·å–é…ç½®çŠ¶æ€<br>é”™è¯¯: ' + error.message + '</div>';
            }
            html += '</div>';
            
            // æµ‹è¯•4ï¼šç³»ç»Ÿä¿¡æ¯
            html += '<div class="test-section">';
            html += '<div class="test-title">4ï¸âƒ£ ç³»ç»Ÿä¿¡æ¯</div>';
            html += '<div class="test-result info">';
            html += `<strong>æµè§ˆå™¨ï¼š</strong> ${navigator.userAgent}<br>`;
            html += `<strong>è¯­è¨€ï¼š</strong> ${navigator.language}<br>`;
            html += `<strong>å¹³å°ï¼š</strong> ${navigator.platform}<br>`;
            html += `<strong>åœ¨çº¿çŠ¶æ€ï¼š</strong> ${navigator.onLine ? 'åœ¨çº¿' : 'ç¦»çº¿'}<br>`;
            html += `<strong>æ—¶é—´ï¼š</strong> ${new Date().toLocaleString('zh-CN')}`;
            html += '</div></div>';
            
            // æ€»ç»“å»ºè®®
            html += '<div class="test-section">';
            html += '<div class="test-title">ğŸ’¡ è¯Šæ–­æ€»ç»“ä¸å»ºè®®</div>';
            html += '<div class="test-result info">';
            html += '<strong>å¦‚æœæ‚¨é‡åˆ°è¶…æ—¶é”™è¯¯ï¼Œè¯·å°è¯•ï¼š</strong><ul>';
            html += '<li>ğŸ”„ ç­‰å¾…å‡ åˆ†é’Ÿåé‡è¯•</li>';
            html += '<li>ğŸ“± åˆ‡æ¢åˆ°æ‰‹æœºçƒ­ç‚¹</li>';
            html += '<li>ğŸ”Œ æ›´æ¢ WiFi ç½‘ç»œ</li>';
            html += '<li>ğŸš« å…³é—­ VPN æˆ–ä»£ç†è½¯ä»¶</li>';
            html += '<li>ğŸ›¡ï¸ æš‚æ—¶å…³é—­é˜²ç«å¢™</li>';
            html += '<li>ğŸŒ ä½¿ç”¨æµè§ˆå™¨çš„éšç§/æ— ç—•æ¨¡å¼</li>';
            html += '</ul>';
            html += '<strong>å¦‚æœé—®é¢˜æŒç»­å­˜åœ¨ï¼š</strong><ul>';
            html += '<li>å¯èƒ½æ˜¯ DeepSeek æœåŠ¡å™¨ç»´æŠ¤æˆ–ç¹å¿™</li>';
            html += '<li>å¯èƒ½æ˜¯åœ°åŒºç½‘ç»œé™åˆ¶</li>';
            html += '<li>å»ºè®®ç¨åå†è¯•æˆ–è”ç³»æŠ€æœ¯æ”¯æŒ</li>';
            html += '</ul></div></div>';
            
            resultsDiv.innerHTML = html;
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œè¯Šæ–­
        window.onload = function() {
            runTests();
        };
    </script>
</body>
</html>

